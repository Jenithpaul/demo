(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[698],{3119:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>m});var r=a(5155),s=a(2115),i=a(3761),l=a(5317),d=a(7227),n=a(5695),c=a(858),o=a(1802);function m(){let{user:e}=(0,i.A)(),t=(0,n.useRouter)(),a=(0,n.useSearchParams)(),m=(0,n.usePathname)(),u=(0,n.useRouter)(),[x,g]=(0,s.useState)("orders"),[h,p]=(0,s.useState)([]),[y,b]=(0,s.useState)([]),[j,v]=(0,s.useState)([]),[N,f]=(0,s.useState)([]),[w,S]=(0,s.useState)([]),[A,C]=(0,s.useState)(!0),[k,P]=(0,s.useState)([]),[I,D]=(0,s.useState)([]),[U,O]=(0,s.useState)({name:"",category:"",price:"",originalPrice:"",image:"",description:"",features:[],specifications:{},inStock:!0,rating:0,reviews:0}),[q,E]=(0,s.useState)(null),[G,L]=(0,s.useState)(0);(0,s.useEffect)(()=>{if((null==e?void 0:e.role)!=="admin")return void t.push("/");M();let a=(0,l.aU)(d.A),r=(0,l.rJ)(a,"products"),s=(0,l.aQ)(r,e=>{S(e.docs.map(e=>({id:e.id,...e.data()})))});return()=>s()},[e,t]),(0,s.useEffect)(()=>{let e=a.get("tab");e&&g(e)},[]);let M=async()=>{let e=(0,l.aU)(d.A);C(!0);try{let t=(0,l.P)((0,l.rJ)(e,"orders"),(0,l.My)("createdAt","desc")),a=(await (0,l.GG)(t)).docs.map(e=>{var t;return{id:e.id,...e.data(),createdAt:null==(t=e.data().createdAt)?void 0:t.toDate()}});p(a);let r=(0,l.P)((0,l.rJ)(e,"enquiries"),(0,l.My)("createdAt","desc")),s=(await (0,l.GG)(r)).docs.map(e=>{var t;return{id:e.id,...e.data(),createdAt:null==(t=e.data().createdAt)?void 0:t.toDate()}});b(s);let i=(0,l.P)((0,l.rJ)(e,"customerService"),(0,l.My)("createdAt","desc")),d=(await (0,l.GG)(i)).docs.map(e=>{var t;return{id:e.id,...e.data(),createdAt:null==(t=e.data().createdAt)?void 0:t.toDate()}});v(d);let n=(0,l.P)((0,l.rJ)(e,"OrderCompleted"),(0,l.My)("createdAt","desc")),c=(await (0,l.GG)(n)).docs.map(e=>{var t;return{id:e.id,...e.data(),createdAt:null==(t=e.data().createdAt)?void 0:t.toDate()}});f(c)}catch(e){console.error("Error fetching data:",e)}finally{C(!1)}},R=async e=>{P(t=>[...t,e.id]),p(t=>t.map(t=>t.id===e.id?{...t,status:"completed"}:t));try{let t=(0,l.aU)(d.A);await (0,l.mZ)((0,l.H9)(t,"orders",e.id),{status:"completed"}),await (0,l.gS)((0,l.rJ)(t,"OrderCompleted"),{...e,orderId:e.id,status:"completed",completedAt:new Date}),f(t=>[{...e,orderId:e.id,status:"completed",completedAt:new Date,id:Math.random().toString(36).slice(2)},...t])}catch(t){p(t=>t.map(t=>t.id===e.id?{...t,status:e.status}:t)),alert("Failed to update order")}finally{P(t=>t.filter(t=>t!==e.id))}},J=async e=>{D(t=>[...t,e.id]),v(t=>t.map(t=>t.id===e.id?{...t,status:"resolved"}:t));try{let t=(0,l.aU)(d.A);await (0,l.mZ)((0,l.H9)(t,"customerService",e.id),{status:"resolved"})}catch(t){v(t=>t.map(t=>t.id===e.id?{...t,status:e.status}:t)),alert("Failed to update service request")}finally{D(t=>t.filter(t=>t!==e.id))}},_=async e=>{e.preventDefault();let t=(0,l.aU)(d.A),a=U.image;if(q){let e=await (0,o.A)(q,{maxSizeMB:1,maxWidthOrHeight:800,useWebWorker:!0});if(e.size>1048576)return void alert("Image is too large after compression. Please choose a smaller image.");let t=(0,c.c7)(d.A),r=(0,c.KR)(t,"product-images/".concat(Date.now(),"_").concat(e.name)),s=(0,c.bp)(r,e);s.on("state_changed",e=>{L(e.bytesTransferred/e.totalBytes*100)}),await s,a=await (0,c.qk)(r),L(0)}await (0,l.gS)((0,l.rJ)(t,"products"),{...U,image:a}),O({name:"",category:"",price:"",originalPrice:"",image:"",description:"",features:[],specifications:{},inStock:!0,rating:0,reviews:0}),E(null),M()},H=e=>{let{name:t,value:a}=e.target;O({...U,[t]:a})},z=e=>{g(e),u.replace("".concat(m,"?tab=").concat(e))};return A?(0,r.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900"})}):(0,r.jsx)(i.O,{children:(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 py-12",children:(0,r.jsxs)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,r.jsxs)("div",{className:"mb-10 flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[(0,r.jsx)("h1",{className:"text-4xl font-bold text-gray-900 mb-4 sm:mb-0",children:"Admin Dashboard"}),(0,r.jsx)("p",{className:"text-gray-500 text-lg",children:"Manage orders, products, and more"})]}),(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsx)("div",{className:"border-b border-gray-200",children:(0,r.jsxs)("nav",{className:"-mb-px flex space-x-8",children:[(0,r.jsx)("button",{onClick:()=>z("orders"),className:"".concat("orders"===x?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"Orders"}),(0,r.jsx)("button",{onClick:()=>z("enquiries"),className:"".concat("enquiries"===x?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"Enquiries"}),(0,r.jsx)("button",{onClick:()=>z("customerService"),className:"".concat("customerService"===x?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"Customer Service"}),(0,r.jsx)("button",{onClick:()=>z("orderHistory"),className:"".concat("orderHistory"===x?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"Order History"}),(0,r.jsx)("button",{onClick:()=>z("products"),className:"".concat("products"===x?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"Products"}),(0,r.jsx)("button",{onClick:()=>z("addProduct"),className:"".concat("addProduct"===x?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"Add Product"}),(0,r.jsx)("button",{onClick:()=>z("manageAdmins"),className:"".concat("manageAdmins"===x?"border-gray-900 text-gray-900":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"," whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm"),children:"Manage Admins"})]})})}),(0,r.jsxs)("div",{className:"mt-8",children:["orders"===x&&(0,r.jsx)("div",{className:"space-y-4",children:h.map(e=>{var t;return(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold",children:["Order #",e.id.slice(-6)]}),(0,r.jsxs)("p",{className:"text-gray-600",children:["Customer: ",e.userEmail]}),(0,r.jsxs)("p",{className:"text-gray-600",children:["Date: ",null==(t=e.createdAt)?void 0:t.toLocaleDateString()]})]}),(0,r.jsx)("span",{className:"px-3 py-1 rounded-full text-sm ".concat("completed"===e.status?"bg-green-100 text-green-800":"pending"===e.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:e.status})]}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("h4",{className:"font-medium mb-2",children:"Items:"}),(0,r.jsx)("ul",{className:"space-y-2",children:e.items.map((e,t)=>(0,r.jsxs)("li",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{children:e.name}),(0,r.jsxs)("span",{children:["Qty: ",e.qty]}),(0,r.jsxs)("span",{children:["₹",e.price]})]},t))})]}),(0,r.jsxs)("div",{className:"mt-4 pt-4 border-t flex justify-between items-center",children:[(0,r.jsxs)("p",{className:"text-right font-semibold",children:["Total: ₹",e.total]}),"completed"!==e.status&&(0,r.jsx)("button",{onClick:()=>R(e),className:"ml-4 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-all disabled:opacity-50",disabled:k.includes(e.id),children:k.includes(e.id)?"Updating...":"Mark as Completed"})]})]},e.id)})}),"enquiries"===x&&(0,r.jsx)("div",{className:"space-y-4",children:y.map(e=>{var t;return(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold",children:["Enquiry #",e.id.slice(-6)]}),(0,r.jsxs)("p",{className:"text-gray-600",children:["From: ",e.email]}),(0,r.jsxs)("p",{className:"text-gray-600",children:["Date: ",null==(t=e.createdAt)?void 0:t.toLocaleDateString()]})]}),(0,r.jsx)("span",{className:"px-3 py-1 rounded-full text-sm ".concat("resolved"===e.status?"bg-green-100 text-green-800":"pending"===e.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:e.status})]}),(0,r.jsx)("div",{className:"mt-4",children:(0,r.jsx)("p",{className:"text-gray-700",children:e.message})})]},e.id)})}),"customerService"===x&&(0,r.jsx)("div",{className:"space-y-4",children:j.map(e=>{var t;return(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold",children:["Service Request #",e.id.slice(-6)]}),(0,r.jsxs)("p",{className:"text-gray-600",children:["From: ",e.email]}),(0,r.jsxs)("p",{className:"text-gray-600",children:["Date: ",null==(t=e.createdAt)?void 0:t.toLocaleDateString()]})]}),(0,r.jsx)("span",{className:"px-3 py-1 rounded-full text-sm ".concat("resolved"===e.status?"bg-green-100 text-green-800":"pending"===e.status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:e.status})]}),(0,r.jsxs)("div",{className:"mt-4 flex justify-between items-center",children:[(0,r.jsx)("p",{className:"text-gray-700",children:e.message}),"resolved"!==e.status&&(0,r.jsx)("button",{onClick:()=>J(e),className:"ml-4 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-all disabled:opacity-50",disabled:I.includes(e.id),children:I.includes(e.id)?"Updating...":"Completed"})]})]},e.id)})}),"orderHistory"===x&&(0,r.jsx)("div",{className:"space-y-4",children:N.map((e,t)=>{var a;return(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold",children:["Order #",e.orderId?e.orderId.slice(-6):e.id.slice(-6)]}),(0,r.jsxs)("p",{className:"text-gray-600",children:["Customer: ",e.userEmail]}),(0,r.jsxs)("p",{className:"text-gray-600",children:["Date: ",null==(a=e.createdAt)?void 0:a.toLocaleDateString()]})]}),(0,r.jsx)("span",{className:"px-3 py-1 rounded-full text-sm bg-green-100 text-green-800",children:"completed"})]}),(0,r.jsxs)("div",{className:"mt-4",children:[(0,r.jsx)("h4",{className:"font-medium mb-2",children:"Items:"}),(0,r.jsx)("ul",{className:"space-y-2",children:e.items.map((t,a)=>(0,r.jsxs)("li",{className:"flex justify-between text-sm",children:[(0,r.jsx)("span",{children:t.name}),(0,r.jsxs)("span",{children:["Qty: ",t.qty]}),(0,r.jsxs)("span",{children:["₹",t.price]})]},"".concat(e.orderId||e.id,"-item-").concat(a)))})]}),(0,r.jsx)("div",{className:"mt-4 pt-4 border-t",children:(0,r.jsxs)("p",{className:"text-right font-semibold",children:["Total: ₹",e.total]})})]},"".concat(e.orderId||e.id,"-").concat(t,"-").concat(Date.now()))})}),"products"===x&&(0,r.jsx)("div",{className:"space-y-4",children:w.map(e=>(0,r.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:(0,r.jsx)("div",{className:"flex justify-between items-start",children:(0,r.jsxs)("div",{children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold",children:["Product #",String(e.id).slice(-6)]}),(0,r.jsxs)("p",{className:"text-gray-600",children:["Name: ",e.name]}),(0,r.jsxs)("p",{className:"text-gray-600",children:["Category: ",e.category]}),(0,r.jsxs)("p",{className:"text-gray-600",children:["Price: ₹",e.price]}),(0,r.jsxs)("p",{className:"text-gray-600",children:["In Stock: ",e.inStock?"Yes":"No"]})]})})},e.id))}),"addProduct"===x&&(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Add New Product"}),(0,r.jsxs)("form",{onSubmit:_,children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-gray-700",children:"Name"}),(0,r.jsx)("input",{type:"text",name:"name",value:U.name,onChange:H,className:"w-full p-2 border rounded",required:!0})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-gray-700",children:"Category"}),(0,r.jsx)("input",{type:"text",name:"category",value:U.category,onChange:H,className:"w-full p-2 border rounded",required:!0})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-gray-700",children:"Price"}),(0,r.jsx)("input",{type:"number",name:"price",value:U.price,onChange:H,className:"w-full p-2 border rounded",required:!0})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-gray-700",children:"Original Price"}),(0,r.jsx)("input",{type:"number",name:"originalPrice",value:U.originalPrice,onChange:H,className:"w-full p-2 border rounded",required:!0})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-gray-700",children:"Image"}),(0,r.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{e.target.files&&e.target.files[0]&&E(e.target.files[0])},className:"w-full p-2 border rounded"}),q&&(0,r.jsx)("img",{src:URL.createObjectURL(q),alt:"Preview",className:"w-32 h-32 object-cover mt-2 border"})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-gray-700",children:"Or Image URL"}),(0,r.jsx)("input",{type:"text",name:"image",value:U.image,onChange:H,className:"w-full p-2 border rounded"})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{className:"block text-gray-700",children:"Description"}),(0,r.jsx)("textarea",{name:"description",value:U.description,onChange:H,className:"w-full p-2 border rounded",required:!0})]}),G>0&&(0,r.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2.5 mb-4",children:(0,r.jsx)("div",{className:"bg-green-500 h-2.5 rounded-full transition-all duration-300",style:{width:"".concat(G,"%")}})}),(0,r.jsx)("button",{type:"submit",className:"px-4 py-2 bg-green-500 text-white rounded",children:"Add Product"})]})]}),"manageAdmins"===x&&(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Manage Admin Users"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"To manage admin users, please visit the dedicated admin management page."}),(0,r.jsx)("a",{href:"/admin/manage-admins",className:"inline-block px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Go to Admin Management"})]})]})]})})})}},3761:(e,t,a)=>{"use strict";a.d(t,{A:()=>u,AuthProvider:()=>m,O:()=>x});var r=a(5155),s=a(2115),i=a(5695),l=a(5317),d=a(6203),n=a(7227);let c=(0,s.createContext)(),o=["jenithpaul66@gmail.com","rakeshchoudhary6321@gmail.com"];function m(e){let{children:t}=e,[a,m]=(0,s.useState)(null),[u,x]=(0,s.useState)(!0),g=(0,i.useRouter)(),h=(0,l.aU)(n.A),p=(0,d.xI)(n.A),y=async()=>{try{let e=(0,l.rJ)(h,"adminUsers"),t=(0,l.P)(e);if((await (0,l.GG)(t)).empty){for(let t of o)await (0,l.gS)(e,{email:t});console.log("Admin users initialized")}}catch(e){console.error("Error initializing admin users:",e)}};(0,s.useEffect)(()=>{y();let e=p.onAuthStateChanged(async e=>{if(e){let t=await b(e.email),a={uid:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL,role:t?"admin":"user"};m(a),localStorage.setItem("user",JSON.stringify(a)),t||g.push("/")}else m(null),localStorage.removeItem("user");x(!1)});return()=>e()},[]);let b=async e=>{try{if(o.includes(e))return!0;let t=(0,l.rJ)(h,"adminUsers"),a=(0,l.P)(t,(0,l._M)("email","==",e));return!(await (0,l.GG)(a)).empty}catch(e){return console.error("Error checking admin access:",e),!1}},j=async(e,t)=>{try{if(await b(e)){let t={email:e,displayName:"Admin User",role:"admin"};return m(t),localStorage.setItem("user",JSON.stringify(t)),g.push("/admin"),!0}return!1}catch(e){return console.error("Login error:",e),!1}},v=async()=>{try{let e=new d.HF,t=await (0,d.df)(p,e);if(!await b(t.user.email))return await (0,d.CI)(p),m(null),localStorage.removeItem("user"),!1;{let e={uid:t.user.uid,email:t.user.email,displayName:t.user.displayName,photoURL:t.user.photoURL,role:"admin"};return m(e),localStorage.setItem("user",JSON.stringify(e)),g.push("/admin"),!0}}catch(e){return console.error("Google login error:",e),!1}},N=async()=>{try{await (0,d.CI)(p),m(null),localStorage.removeItem("user"),g.push("/")}catch(e){console.error("Logout error:",e)}};return(0,r.jsx)(c.Provider,{value:{user:a,setUser:m,login:j,loginWithGoogle:v,logout:N,loading:u},children:!u&&t})}function u(){let e=(0,s.useContext)(c);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}function x(e){let{children:t}=e,{user:a,loading:l}=u(),d=(0,i.useRouter)();return((0,s.useEffect)(()=>{l||a&&"admin"===a.role||d.push("/login")},[a,l,d]),l)?(0,r.jsx)("div",{children:"Loading..."}):a&&"admin"===a.role?t:null}},6591:(e,t,a)=>{Promise.resolve().then(a.bind(a,3119))},7227:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(3915).Wp)({apiKey:"AIzaSyCvcy_H0WmnKLnTPMnl_gcX96IArDjUvG8",authDomain:"wood-ply-5467f.firebaseapp.com",projectId:"wood-ply-5467f",storageBucket:"wood-ply-5467f.appspot.com",messagingSenderId:"11936944340",appId:"1:11936944340:web:d723588893d69d5dfb2b41"})}},e=>{var t=t=>e(e.s=t);e.O(0,[992,163,75,103,441,684,358],()=>t(6591)),_N_E=e.O()}]);