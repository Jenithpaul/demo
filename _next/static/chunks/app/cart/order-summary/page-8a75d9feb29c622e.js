(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[55],{336:(e,t,r)=>{"use strict";r.d(t,{default:()=>d});var a=r(5155),n=r(2115),i=r(3072),s=r(3761),l=r(6874),o=r.n(l),c=r(5317),u=r(7227);function d(){let{cart:e,clearCart:t}=(0,i._)(),{user:r}=(0,s.A)(),[l,d]=(0,n.useState)(!1),m=(0,c.aU)(u.A),f=async()=>{if(!r)return void alert("Please login to place an order");if(0===e.length)return void alert("Your cart is empty");d(!0);try{let a={userId:r.uid,userEmail:r.email,items:e.map(e=>({id:e.id,name:e.name,price:e.price,qty:e.qty||1})),total:e.reduce((e,t)=>e+t.price*(t.qty||1),0),status:"pending",createdAt:(0,c.O5)()};await (0,c.gS)((0,c.rJ)(m,"orders"),a);let n=function(e){if(!e.length)return"No items in cart.";let t="Order Details:%0A";e.forEach((e,r)=>{t+="".concat(r+1,". ").concat(e.name," x").concat(e.qty||1," - ₹").concat(e.price," each%0A")});let r=e.reduce((e,t)=>e+t.price*(t.qty||1),0);return t+="%0ATotal: ₹".concat(r)}(e);window.open("https://wa.me/".concat("91999999999","?text=").concat(n),"_blank"),t(),alert("Order placed successfully!")}catch(e){console.error("Error placing order:",e),alert("Failed to place order. Please try again.")}finally{d(!1)}},h=e.reduce((e,t)=>e+t.price*(t.qty||1),0);return(0,a.jsxs)("div",{className:"max-w-xl mx-auto p-6 bg-white rounded-xl shadow-lg mt-8",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Order Summary"}),(0,a.jsx)("ul",{className:"mb-4",children:e.map((e,t)=>(0,a.jsxs)("li",{className:"flex justify-between py-2 border-b",children:[(0,a.jsxs)("span",{children:[t+1,". ",e.name," x",e.qty||1]}),(0,a.jsxs)("span",{children:["₹",e.price*(e.qty||1)]})]},e.id))}),(0,a.jsxs)("div",{className:"flex justify-between font-semibold text-lg mb-6",children:[(0,a.jsx)("span",{children:"Total"}),(0,a.jsxs)("span",{children:["₹",h]})]}),(0,a.jsx)("button",{onClick:f,disabled:0===e.length||l,className:"w-full flex items-center justify-center gap-2 py-3 bg-green-600 text-white font-semibold rounded-xl hover:bg-green-700 transition-all duration-300 shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:l?"Processing...":(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("img",{src:"/images/whatsapp.svg",alt:"WhatsApp",className:"w-5 h-5"}),"Place Order via WhatsApp"]})}),(0,a.jsx)(o(),{href:"/cart",className:"block text-center mt-4 text-green-700 hover:underline",children:"Back to Cart"})]})}},3072:(e,t,r)=>{"use strict";r.d(t,{CartProvider:()=>c,_:()=>u});var a=r(5155),n=r(2115),i=r(6203),s=r(5317),l=r(7227);let o=(0,n.createContext)();function c(e){let{children:t}=e,[r,c]=(0,n.useState)(()=>{{let e=localStorage.getItem("cart");if(e)try{return JSON.parse(e)}catch(e){}}return[]}),[u,d]=(0,n.useState)(null),m=(0,n.useRef)(!1),f=(0,n.useRef)(null);function h(){c([])}(0,n.useEffect)(()=>{let e=(0,i.xI)(l.A).onAuthStateChanged(e=>{if(d(e?e.uid:null),!e){let e=localStorage.getItem("cart");e?c(JSON.parse(e)):c([])}});return()=>e()},[]),(0,n.useEffect)(()=>{if(!u)return;let e=(0,s.aU)(l.A),t=(0,s.H9)(e,"carts",u),r=(0,s.aQ)(t,e=>{if(e.exists())m.current=!0,f.current=JSON.stringify(e.data().cart||[]),c(e.data().cart||[]);else{let e=localStorage.getItem("cart");e&&JSON.parse(e).length>0?((0,s.BN)(t,{cart:JSON.parse(e)},{merge:!0}),c(JSON.parse(e))):(m.current=!0,f.current=JSON.stringify([]),c([]))}});return()=>r()},[u]),(0,n.useEffect)(()=>{if(u){if(m.current){m.current=!1;return}if(JSON.stringify(r)===f.current)return;let e=(0,s.aU)(l.A);(0,s.BN)((0,s.H9)(e,"carts",u),{cart:r},{merge:!0})}else localStorage.setItem("cart",JSON.stringify(r))},[r,u]),(0,n.useEffect)(()=>{localStorage.setItem("cart",JSON.stringify(r))},[r]);let p=async e=>{if(!u)return;let t=(0,s.aU)(l.A),a={items:r,...e,createdAt:new Date().toISOString()};await (0,s.mZ)((0,s.H9)(t,"orders",u),{history:(0,s.hq)(a)}).catch(async e=>{await (0,s.BN)((0,s.H9)(t,"orders",u),{history:[a]})}),h()};return(0,a.jsx)(o.Provider,{value:{cart:r,setCart:c,addToCart:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;c(r=>-1!==r.findIndex(t=>t.id===e.id)?r.map(r=>r.id===e.id?{...r,qty:(r.qty||1)+(e.qty||t)}:r):[...r,{...e,qty:e.qty||t}])},removeFromCart:function(e){c(t=>t.filter(t=>t.id!==e))},updateCartQty:function(e,t){c(r=>r.map(r=>r.id===e?{...r,qty:t}:r))},clearCart:h,placeOrder:p},children:t})}function u(){return(0,n.useContext)(o)}},3761:(e,t,r)=>{"use strict";r.d(t,{A:()=>m,AuthProvider:()=>d,O:()=>f});var a=r(5155),n=r(2115),i=r(5695),s=r(5317),l=r(6203),o=r(7227);let c=(0,n.createContext)(),u=["jenithpaul66@gmail.com","rakeshchoudhary6321@gmail.com"];function d(e){let{children:t}=e,[r,d]=(0,n.useState)(null),[m,f]=(0,n.useState)(!0),h=(0,i.useRouter)(),p=(0,s.aU)(o.A),g=(0,l.xI)(o.A),y=async()=>{try{let e=(0,s.rJ)(p,"adminUsers"),t=(0,s.P)(e);if((await (0,s.GG)(t)).empty){for(let t of u)await (0,s.gS)(e,{email:t});console.log("Admin users initialized")}}catch(e){console.error("Error initializing admin users:",e)}};(0,n.useEffect)(()=>{y();let e=g.onAuthStateChanged(async e=>{if(e){let t=await x(e.email),r={uid:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL,role:t?"admin":"user"};d(r),localStorage.setItem("user",JSON.stringify(r)),t||h.push("/")}else d(null),localStorage.removeItem("user");f(!1)});return()=>e()},[]);let x=async e=>{try{if(u.includes(e))return!0;let t=(0,s.rJ)(p,"adminUsers"),r=(0,s.P)(t,(0,s._M)("email","==",e));return!(await (0,s.GG)(r)).empty}catch(e){return console.error("Error checking admin access:",e),!1}},S=async(e,t)=>{try{if(await x(e)){let t={email:e,displayName:"Admin User",role:"admin"};return d(t),localStorage.setItem("user",JSON.stringify(t)),h.push("/admin"),!0}return!1}catch(e){return console.error("Login error:",e),!1}},w=async()=>{try{let e=new l.HF,t=await (0,l.df)(g,e);if(!await x(t.user.email))return await (0,l.CI)(g),d(null),localStorage.removeItem("user"),!1;{let e={uid:t.user.uid,email:t.user.email,displayName:t.user.displayName,photoURL:t.user.photoURL,role:"admin"};return d(e),localStorage.setItem("user",JSON.stringify(e)),h.push("/admin"),!0}}catch(e){return console.error("Google login error:",e),!1}},N=async()=>{try{await (0,l.CI)(g),d(null),localStorage.removeItem("user"),h.push("/")}catch(e){console.error("Logout error:",e)}};return(0,a.jsx)(c.Provider,{value:{user:r,setUser:d,login:S,loginWithGoogle:w,logout:N,loading:m},children:!m&&t})}function m(){let e=(0,n.useContext)(c);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}function f(e){let{children:t}=e,{user:r,loading:s}=m(),l=(0,i.useRouter)();return((0,n.useEffect)(()=>{s||r&&"admin"===r.role||l.push("/login")},[r,s,l]),s)?(0,a.jsx)("div",{children:"Loading..."}):r&&"admin"===r.role?t:null}},7227:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(3915).Wp)({apiKey:"AIzaSyCvcy_H0WmnKLnTPMnl_gcX96IArDjUvG8",authDomain:"wood-ply-5467f.firebaseapp.com",projectId:"wood-ply-5467f",storageBucket:"wood-ply-5467f.appspot.com",messagingSenderId:"11936944340",appId:"1:11936944340:web:d723588893d69d5dfb2b41"})},9910:(e,t,r)=>{Promise.resolve().then(r.bind(r,336))}},e=>{var t=t=>e(e.s=t);e.O(0,[992,163,75,874,441,684,358],()=>t(9910)),_N_E=e.O()}]);