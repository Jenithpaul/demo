(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{1086:(e,t,r)=>{Promise.resolve().then(r.bind(r,3761)),Promise.resolve().then(r.bind(r,3072)),Promise.resolve().then(r.t.bind(r,4146,23)),Promise.resolve().then(r.t.bind(r,6686,23)),Promise.resolve().then(r.t.bind(r,9324,23))},3072:(e,t,r)=>{"use strict";r.d(t,{CartProvider:()=>u,_:()=>c});var a=r(5155),i=r(2115),n=r(6203),s=r(5317),o=r(7227);let l=(0,i.createContext)();function u(e){let{children:t}=e,[r,u]=(0,i.useState)(()=>{{let e=localStorage.getItem("cart");if(e)try{return JSON.parse(e)}catch(e){}}return[]}),[c,d]=(0,i.useState)(null),m=(0,i.useRef)(!1),f=(0,i.useRef)(null);function y(){u([])}(0,i.useEffect)(()=>{let e=(0,n.xI)(o.A).onAuthStateChanged(e=>{if(d(e?e.uid:null),!e){let e=localStorage.getItem("cart");e?u(JSON.parse(e)):u([])}});return()=>e()},[]),(0,i.useEffect)(()=>{if(!c)return;let e=(0,s.aU)(o.A),t=(0,s.H9)(e,"carts",c),r=(0,s.aQ)(t,e=>{if(e.exists())m.current=!0,f.current=JSON.stringify(e.data().cart||[]),u(e.data().cart||[]);else{let e=localStorage.getItem("cart");e&&JSON.parse(e).length>0?((0,s.BN)(t,{cart:JSON.parse(e)},{merge:!0}),u(JSON.parse(e))):(m.current=!0,f.current=JSON.stringify([]),u([]))}});return()=>r()},[c]),(0,i.useEffect)(()=>{if(c){if(m.current){m.current=!1;return}if(JSON.stringify(r)===f.current)return;let e=(0,s.aU)(o.A);(0,s.BN)((0,s.H9)(e,"carts",c),{cart:r},{merge:!0})}else localStorage.setItem("cart",JSON.stringify(r))},[r,c]),(0,i.useEffect)(()=>{localStorage.setItem("cart",JSON.stringify(r))},[r]);let h=async e=>{if(!c)return;let t=(0,s.aU)(o.A),a={items:r,...e,createdAt:new Date().toISOString()};await (0,s.mZ)((0,s.H9)(t,"orders",c),{history:(0,s.hq)(a)}).catch(async e=>{await (0,s.BN)((0,s.H9)(t,"orders",c),{history:[a]})}),y()};return(0,a.jsx)(l.Provider,{value:{cart:r,setCart:u,addToCart:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;u(r=>-1!==r.findIndex(t=>t.id===e.id)?r.map(r=>r.id===e.id?{...r,qty:(r.qty||1)+(e.qty||t)}:r):[...r,{...e,qty:e.qty||t}])},removeFromCart:function(e){u(t=>t.filter(t=>t.id!==e))},updateCartQty:function(e,t){u(r=>r.map(r=>r.id===e?{...r,qty:t}:r))},clearCart:y,placeOrder:h},children:t})}function c(){return(0,i.useContext)(l)}},3761:(e,t,r)=>{"use strict";r.d(t,{A:()=>m,AuthProvider:()=>d,O:()=>f});var a=r(5155),i=r(2115),n=r(5695),s=r(5317),o=r(6203),l=r(7227);let u=(0,i.createContext)(),c=["jenithpaul66@gmail.com","rakeshchoudhary6321@gmail.com"];function d(e){let{children:t}=e,[r,d]=(0,i.useState)(null),[m,f]=(0,i.useState)(!0),y=(0,n.useRouter)(),h=(0,s.aU)(l.A),g=(0,o.xI)(l.A),p=async()=>{try{let e=(0,s.rJ)(h,"adminUsers"),t=(0,s.P)(e);if((await (0,s.GG)(t)).empty){for(let t of c)await (0,s.gS)(e,{email:t});console.log("Admin users initialized")}}catch(e){console.error("Error initializing admin users:",e)}};(0,i.useEffect)(()=>{p();let e=g.onAuthStateChanged(async e=>{if(e){let t=await S(e.email),r={uid:e.uid,email:e.email,displayName:e.displayName,photoURL:e.photoURL,role:t?"admin":"user"};d(r),localStorage.setItem("user",JSON.stringify(r)),t||y.push("/")}else d(null),localStorage.removeItem("user");f(!1)});return()=>e()},[]);let S=async e=>{try{if(c.includes(e))return!0;let t=(0,s.rJ)(h,"adminUsers"),r=(0,s.P)(t,(0,s._M)("email","==",e));return!(await (0,s.GG)(r)).empty}catch(e){return console.error("Error checking admin access:",e),!1}},N=async(e,t)=>{try{if(await S(e)){let t={email:e,displayName:"Admin User",role:"admin"};return d(t),localStorage.setItem("user",JSON.stringify(t)),y.push("/admin"),!0}return!1}catch(e){return console.error("Login error:",e),!1}},v=async()=>{try{let e=new o.HF,t=await (0,o.df)(g,e);if(!await S(t.user.email))return await (0,o.CI)(g),d(null),localStorage.removeItem("user"),!1;{let e={uid:t.user.uid,email:t.user.email,displayName:t.user.displayName,photoURL:t.user.photoURL,role:"admin"};return d(e),localStorage.setItem("user",JSON.stringify(e)),y.push("/admin"),!0}}catch(e){return console.error("Google login error:",e),!1}},b=async()=>{try{await (0,o.CI)(g),d(null),localStorage.removeItem("user"),y.push("/")}catch(e){console.error("Logout error:",e)}};return(0,a.jsx)(u.Provider,{value:{user:r,setUser:d,login:N,loginWithGoogle:v,logout:b,loading:m},children:!m&&t})}function m(){let e=(0,i.useContext)(u);if(!e)throw Error("useAuth must be used within an AuthProvider");return e}function f(e){let{children:t}=e,{user:r,loading:s}=m(),o=(0,n.useRouter)();return((0,i.useEffect)(()=>{s||r&&"admin"===r.role||o.push("/login")},[r,s,o]),s)?(0,a.jsx)("div",{children:"Loading..."}):r&&"admin"===r.role?t:null}},4146:e=>{e.exports={style:{fontFamily:"'Geist', 'Geist Fallback'",fontStyle:"normal"},className:"__className_5dd90f",variable:"__variable_5dd90f"}},6686:e=>{e.exports={style:{fontFamily:"'Geist Mono', 'Geist Mono Fallback'",fontStyle:"normal"},className:"__className_f5fb7b",variable:"__variable_f5fb7b"}},7227:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(3915).Wp)({apiKey:"AIzaSyCvcy_H0WmnKLnTPMnl_gcX96IArDjUvG8",authDomain:"wood-ply-5467f.firebaseapp.com",projectId:"wood-ply-5467f",storageBucket:"wood-ply-5467f.appspot.com",messagingSenderId:"11936944340",appId:"1:11936944340:web:d723588893d69d5dfb2b41"})},9324:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[1,992,163,75,441,684,358],()=>t(1086)),_N_E=e.O()}]);